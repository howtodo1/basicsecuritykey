import serial

ser = serial.Serial('/dev/tty.usbserial-0001', 115200) 
byts = b'\xa8\x90?\x0f\xe2\xec\x90?{\x99D\xc8eF\xa0\xce\xd1\xb0\xb7\x84\x92!n\xf5\x08G]w\x81\xe7\xeex9A49\xdc\x89K\x05\x99qQ\xe8E\xefx\xf4\x19\xa8\xab\x80\xd7\x9f\x98l\xb4\x8c\xbf/\xb9\x8a}U\x1c{*\xd4\t\xc2\x02\t\xd0\x1e\xd5\x9arrH\xe2v@;\x80\xf9\xb7\xca\x08\x03\x12\x0b]\x19\x95<f\xb7\x98\xc6\x8ag\x0f\x8f\xd4\xf7A\xd9\xb05\xb8-KR\xc6\x05GE/|\xef\x8b\xba\xd5\x9c\xe0P\x15\xf3\xc5\xaf\xa1\x9d\x9dv\xd7[\x10\x04pa6\xcbTV\xf1\\g\xa8k\r6e1\xc0\xea\xb8\x1b\rz1\x9bw\xdf\x85\x16c\x1e.\xdd-\x04r\xb7\xa99\xd0\xf1.>L\xe33\x04\xc5;\r\xb9\xe4\xe2\xa6\x8b\x0cIF\x87\xf8L\xf2\xe9\xe5_\xb8\xbfrF\xaf8\x0b\x84\xa9\xd4K\n\xe7\xa2\xedm\xc6U\xd6\xad\xad1V~\x93\xb4\xa6T\x19\xb1\x18+;wMY93P$4R\x10\xd4\x07\xb2\x8c\xb83\xabp\x03\x1ba\xb3'
snt = False
try:
    while True:
        data = ser.readline()
        print(f'Received data: {data}')
        if data == b'>\r\n': # Check if it is asking for encrypted data
            data_to_send = byts.hex() + "\r\n"
            ser.write(data_to_send.encode("UTF-8")) # Give encrypted data for it to decrypt
            print("Decrypting...")
            ser.readline() #Skip useless data
            data = ser.readline() #Wait for decrypted string
            print(data.decode("UTF-8"))


except KeyboardInterrupt:
    ser.close()
    print('Serial port closed.')
