from rsa import RSA, genrsa
#from machine import Pin, SoftI2C, UART
#import ssd1306
def main():
    #i2c = SoftI2C(scl=Pin(22), sda=Pin(21))


    #oled_width = 128
    #oled_height = 32
    #oled = ssd1306.SSD1306_I2C(oled_width, oled_height, i2c)
    bits = 2048

    r = RSA(*genrsa(bits, e=65537, n=22844016404727758843775687051940287598974678231304687972699194239497463990007179937199334388674733076944798800417915297736323160920339245917823374587096481228706928683545848316554674861382114893910313065191755904236299595831982163069257511373594115870648555228347173289907423296935495128072064469174832685372028346425215202614218323710527374004913862101378010725507656630340535332206311162078546431734388605404097593288885881603595431454713921350330115956194661843980184691910786879317708782318754490546035983514802956614439851605576594747664162734612066597511124338565089903304673969613150493453401618488227032688359, d=1746667778569217382030913343870985567823704359629946311720030857898924150539786359847198752180433761822640444159698697788374740366080534069216060089048025808887352482311491919286135705485233955374591128212702577721410764525597183562568463455652228735337594187241522885632941668690110412236890841128447847573091560265460149391673859811674764579955895052018446771121234266109261628976280133887712188235616041391069816234717453987282258846864846102750037383431393526857868905703265437921626595019491472198249046446877126800810092714978599616038125378828454857438431611148744082684290985684800685246661044154517963786521))
    if r:
        #oled.text('Waiting for data', 0, 0)
        #oled.show()
        print(">")
        dta = input("")
        #oled.text('Decrypting...', 0, 10)
        #oled.show()
        print(r.pkcs_decrypt(bytes.fromhex(dta)).decode("UTF-8"))
        #oled.text('Done!', 0, 20)
        #oled.show()


if __name__ == "__main__":
    main()

