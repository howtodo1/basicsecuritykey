from rsa import RSA, genrsa
#from machine import Pin, SoftI2C, UART
#import ssd1306
def main():
    #i2c = SoftI2C(scl=Pin(22), sda=Pin(21))


    #oled_width = 128
    #oled_height = 32
    #oled = ssd1306.SSD1306_I2C(oled_width, oled_height, i2c)
    byts = b'\x1b\xfe\x01^\xd3\xceX\xeb\x99\x04\x8ae\xee\xb9\xca<\xde\x027\xe8M\xb5e\x7f\xdf\x03\xe8\x82\x80\x12\tU\xcc\x98G \x12\x93\xae\x1b>\xccF\xd1\xafJU\xc9\xe5\xacp\x84W\x08\x8e\xf0\x9d\xa3%\xc1\xa5\x85Q\x08\x07\x8c\xe4\xa3\x8f\xaca\xb61\xf9\xc3jh\xeb\x18Os\x8e\xcc\x8d\x08\x9b\x03\x84\x82\x9f[\x0c\xc4iM\x9fy}\xd5\xcf\xd9\xa8\x80Pg\xe3\xbf&xWf\x8fj\x13\xb7Q\xbb\x97R\xeaW\xc7\xcb\x0f\xb1h(r\xae\x99\xf8\xc2\xe3\x02\xd2`*\xff\x84\'\xb0\xcf\x16\xe6\xcf\xd5j\xee\x81X0?V\t\x88\x0e\x80<h\\\xdb\xb9>\xa2\xfe\xecp!\x94\xca\xef\xab\x13%8\xa5-\xf6O\xe8oX<*\x88\x98\xaa\xe6n~\x04\xd4\xff4\x84j\xf7\xc7\n\r?\x15$\xc3m\xeb0\xcf\xbc\xf0\xaa="\xf8\x194\xb6\xc42\x8as\xc5\xe2+\xca\xc8\x82tJ\xd3\x91\x08\xf5\x1e\xf20:x\\[5^\x03\x96K\x94U\xd0}vC\x84\xbd0\x05\xff'
    bits = 2048

    r = RSA(*genrsa(bits, e=65537, n=22844016404727758843775687051940287598974678231304687972699194239497463990007179937199334388674733076944798800417915297736323160920339245917823374587096481228706928683545848316554674861382114893910313065191755904236299595831982163069257511373594115870648555228347173289907423296935495128072064469174832685372028346425215202614218323710527374004913862101378010725507656630340535332206311162078546431734388605404097593288885881603595431454713921350330115956194661843980184691910786879317708782318754490546035983514802956614439851605576594747664162734612066597511124338565089903304673969613150493453401618488227032688359, d=1746667778569217382030913343870985567823704359629946311720030857898924150539786359847198752180433761822640444159698697788374740366080534069216060089048025808887352482311491919286135705485233955374591128212702577721410764525597183562568463455652228735337594187241522885632941668690110412236890841128447847573091560265460149391673859811674764579955895052018446771121234266109261628976280133887712188235616041391069816234717453987282258846864846102750037383431393526857868905703265437921626595019491472198249046446877126800810092714978599616038125378828454857438431611148744082684290985684800685246661044154517963786521))
    if r:
        #oled.text('Waiting for data', 0, 0)
        #oled.show()
        print(">")
        dta = input("")
        #oled.text('Decrypting...', 0, 10)
        #oled.show()
        print(r.pkcs_decrypt(bytes.fromhex(dta)).decode("UTF-8"))
        #oled.text('Done!', 0, 20)
        #oled.show()


if __name__ == "__main__":
    main()

